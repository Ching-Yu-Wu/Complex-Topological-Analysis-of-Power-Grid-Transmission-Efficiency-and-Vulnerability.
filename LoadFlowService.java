package ncku.topology.model;

import ncku.topology.web.PowerGridController;
import org.apache.poi.ss.usermodel.*;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;

import java.io.File;
import java.io.IOException;

@Service
public class LoadFlowService {
  Logger logger = LoggerFactory.getLogger(this.getClass());

  public void loadFlow(Workbook workbook) throws IOException {
    Sheet wsBus = workbook.getSheet("bus");
    Sheet wsLine = workbook.getSheet("line");

    int i = 1;
    int max = 0;
    int NPV = 0;

    while (wsBus.getRow(i) != null && wsBus.getRow(i).getCell(0).getCellType() != CellType.BLANK) {
      if (wsBus.getRow(i).getCell(0).getNumericCellValue() > max) {
        max = (int) wsBus.getRow(i).getCell(0).getNumericCellValue();
      }
      if (wsBus.getRow(i).getCell(1).getNumericCellValue() == 2) {
        NPV++;
      }
      i++;
    }

    int NB = max;
    double[][] BL = new double[NB][NB];

    i = 1;
    while (wsLine.getRow(i) != null && wsLine.getRow(i).getCell(0).getCellType() != CellType.BLANK) {
      int index1 = (int) wsLine.getRow(i).getCell(0).getNumericCellValue() - 1;
      int index2 = (int) wsLine.getRow(i).getCell(1).getNumericCellValue() - 1;
      BL[index1][index2] = wsLine.getRow(i).getCell(4).getNumericCellValue();
      i++;
    }

    // Continue with the rest of the code...
    logger.info("Here");

  }
}

